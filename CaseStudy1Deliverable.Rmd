---
title: "CaseStudy1Deliverable"
author: "Rajat Chandna, Andy Ho, An Nguyen, Jodi Pafford, and Tori Wheelis"
date: "June 17, 2018"
output: 
  html_document:
    keep_md: yes
---

#Introduction

The purpose of this study is to help "Company Name" assess the market size and competition on where the next "Company Name" brewery should be built and what type of beer it should brew. The data used in this study was derived from "Author of Data" and includes 2410 US craft beers from 558 US breweries. (see Codebook for specific details)

#Guiding Questions

###Breweries per state
The 558 breweries are spread among "# of States".  The most breweries are located in "state".  

```{r Q1, echo=TRUE}
#Q2 - Merge Beer and Breweries files by Brew_ID (Assumes Beers.csv file has renamed Brewery_ID to Brew_ID) and prints the first/last 6 observations.
beers <- read.csv("CleanedBeerData.csv", header = TRUE)
breweries <- read.csv("CleanedBreweryData.csv", header = TRUE)
master.file <- Reduce(function(beers, breweries) merge(beers, breweries, by="Brew_ID"), list(beers, breweries))
write.csv(master.file, file = "masterfile.csv", row.names = FALSE)
state.count <- as.data.frame(table(master.file$State))
names(state.count) <- c("State", "Brewery_Count")
state.count
library(ggplot2)
states <- data.frame(master.file$Brew_ID, master.file$State)
StatePlot <- ggplot(states, aes(x=master.file.State, color=master.file.State)) + geom_bar(stat="Count", width = 0.75) + labs(x = "State") + theme(legend.position = "none") + coord_flip()
StatePlot

```

###First 6, Last 6
Some of the observations are seen below.  The data gathered includes 

```{rQ2, echo = TRUE}
#Q2 - Merge Beer and Breweries files by Brew_ID and prints the first/last 6 observations.
beers <- read.csv("Beers.csv", header = TRUE)
names(breweries) <- c("Brewery_id", "Name", "City", "State")
master.file <- Reduce(function(beers, breweries) merge(beers, breweries, by="Brewery_id"), list(beers, breweries))
names(master.file) <- c("Brewery_id", "Beer_name", "Beer_id", "ABV", "IBU", "Style", "Ounces", "Brewery_name", "City", "State")
head(master.file,6)
tail(master.file,6)
write.csv(master.file, file = "masterfile.csv", row.names = FALSE)
```

###Number of NA's
Some of the data was incomplete.  A summary of incomplete information is shown below.

```{r Q3, echo = TRUE}
#Q3 - Summing the NA's for each column
colSums(is.na(master.file))
```

###Median Alcohol Content & International Bitterness Unti (IBU) for each state
The median amount of alcohol content and IBUs in each state is listed below. "Add Info about scatterplot"
```{rQ4, echo = TRUE}
medianIBUABV<-aggregate.data.frame(master.file[, 4:5], list(master.file$State), median, na.rm=TRUE)
states<-rep(medianIBUABV$Group.1,2)
values<-c(medianIBUABV$ABV, medianIBUABV$IBU)
type <-c(rep("ABV", 51), rep("IBU", 51))
data<-data.frame(states, values)

ggplot(data, aes(states, values)) +
  geom_bar(stat = "identity", aes(fill = type), position = "dodge") +
  xlab("States") +
  ggtitle("Median State ABV & IBU") +
  theme_bw()

# This works but need to work on the scale of the ABV
```

###Maximum Alcoholic (ABV) and Most Bitter(IBU) Beer
Based on the information gathered "Name of state" has the highest alcohol by volumne (ABV) and "Name of state" has the highest rating of International Bitterness Units (IBU) compared to the other states.
```{r Q5, echo = TRUE}
MaxABV <- aggregate(ABV~State, data=master.file, max)
MaxABV
MaxABV[order(MaxABV$ABV),]
MaxIBU <- aggregate(IBU~State, data=master.file, max)
MaxIBU
MaxIBU[order(MaxIBU$IBU),]

```

###Maximum Alcoholic (ABV) and Most Bitter(IBU) Beer
Based on the information gathered, Colorado has the beer with the highest alcohol by volumne (ABV) and Oregon has the beer with the highest rating of International Bitterness Units (IBU) compared to the other states.
```{rQ5, echo = TRUE}

```

###ABV Summary
"Insert data about Min, Max, quartiles, etc."

```{rQ6, echo = TRUE}
summary(BeersandBreweries$ABV)
```

###IBU and ABV relationship
"Insert data and description of relationship between IBU and ABV"
```{rQ7, echo = TRUE}
plot(ABV, IBU, main="Relationship Between Beer Bitternes and its Alcoholic Content",
   xlab="ABV: Alcohol By Volume", ylab="IBU: International Bitterness Units", pch=19) 

ggplot(master.file, aes(x=ABV, y=IBU)) + geom_point()
```

#Summary


